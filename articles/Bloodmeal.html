<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MicroWNV">
<title>Biting distribution and transmission â€¢ MicroWNV</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Biting distribution and transmission">
<meta property="og:description" content="MicroWNV">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MicroWNV</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Bloodmeal.html">Biting distribution and transmission</a>
    <a class="dropdown-item" href="../articles/Contributing.html">Contributing</a>
    <a class="dropdown-item" href="../articles/SIRS_birds.html">SIRS bird model</a>
    <a class="dropdown-item" href="../articles/Simple_example.html">Example WNV simulation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/MicroWNV/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Biting distribution and transmission</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/MicroWNV/blob/HEAD/vignettes/Bloodmeal.Rmd" class="external-link"><code>vignettes/Bloodmeal.Rmd</code></a></small>
      <div class="d-none name"><code>Bloodmeal.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="biting-distribution-matrix">Biting distribution matrix<a class="anchor" aria-label="anchor" href="#biting-distribution-matrix"></a>
</h2>
<p>In <strong>MicroWNV</strong> the bloodmeal function uses generic interfaces of the human, adult mosquito, and adult bird components to compute quantities used to simulate transmission of pathogens between the species. It is a function (not a method that dispatches) because it enforces mathematical consistency in how transmission is calculated, regardless of the specific models used to implement each component.</p>
<p>The <code>compute_bloodmeal</code> function which implements this is called after any vector control functions have been called but before any <code>update</code> functions which update model components over a time step have been called. Here we describe how the calculation works, and how it is implemented in the code.</p>
<p>Using the generic human interface we calculate the following values:</p>
<ul>
<li>
<code>W</code>: from <code>compute_W</code>, gives the weighted person time at risk spent at each patch</li>
<li>
<code>H</code>: from <code>compute_H</code>, gives the total population in each strata</li>
<li>
<code>x</code>: from <code>compute_x</code>, gives the net infectiousness from humans in each strata</li>
<li>
<code>wf</code>: from <code>compute_wf</code>, gives the biting weights of each strata</li>
<li>
<code>Psi</code>: from <code>compute_Psi</code>, gives the time at risk matrix</li>
</ul>
<p>Likewise we use the generic bird interface to calculate:</p>
<ul>
<li>
<code>WB</code>: from <code>compute_WB</code>, gives the weighted bird time at risk spent at each patch</li>
<li>
<code>B_pop</code>: from <code>compute_B_pop</code>, gives the total bird population in each patch</li>
<li>
<code>xB</code>: from <code>compute_xB</code>, gives the net infectiousness from birds in each patch</li>
<li>
<code>wfB</code>: from <code>compute_wfB</code>, gives the bird biting weights of each patch</li>
<li>
<code>PsiB</code>: from <code>compute_PsiB</code>, gives the bird time at risk matrix</li>
</ul>
<p>Two biting distribution matrices (from mosquitoes to humans and birds, respectively) are calculated:</p>
<p><span class="math display">\[\begin{equation}
\beta_{H_{n\times p}} = \mbox{diag}(w_{f}) \cdot \Psi \cdot \mbox{diag}(1/W) \\
\beta_{B_{p\times p}} = \mbox{diag}(w_{f_{B}}) \cdot \Psi_{B} \cdot \mbox{diag}(1/W_{B}) \\
\end{equation}\]</span></p>
<p>After these values have been computed we compute <span class="math inline">\(f\)</span>, the blood feeding rate, and <span class="math inline">\(q\)</span>, the proportion of blood meals on human hosts. These use the generic interface functions <code>compute_f</code> and <code>compute_q</code>, which dispatch on the adult mosquito type.</p>
<p>Finally the transmission terms which each component uses to independently update over a time step are calculated and sent to each component. These are the EIR (entomological inoculation rate) for humans and birds, and <span class="math inline">\(\kappa\)</span>, the net infectiousness of blood hosts (humans and birds) to mosquitoes.</p>
<p><span class="math display">\[\begin{equation}
EIR_{H_{n\times 1}} = \beta_{H} \cdot (fqZ) \\
EIR_{B_{p\times 1}} = \beta_{B} \cdot (f(1-q)Z) \\
\kappa_{p\times 1} = q \cdot \beta_{H}^{\intercal} \cdot xH + (1 - q) \cdot \beta_{B}^{\intercal} \cdot x_{B} B_{pop}
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="force-of-infection">Force of infection<a class="anchor" aria-label="anchor" href="#force-of-infection"></a>
</h2>
<p>Once the above terms have been computed, most models will use them in a fairly similar way to compute a force of infection term. For the mosquito component, it is given as <span class="math inline">\(\kappa fq\)</span>, the per-capita rate of infection in mosquito population. Humans and birds compute <span class="math inline">\(h = b EIR\)</span>. While the specific way that each of these terms is computed and how state is updated using these terms may change between models, all models will use or can be modified to take as input these terms.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
